name: CI-CD

on: 
push:
branches: ["main"]
workflow_dispatch:

jobs:
CI:
runs-on: ubuntu-lastest
steps:
- name: Checkout da base de códigos
uses: actions/checkout@v3.6.0
- name: Autenticação no Docker Hub
uses: docker/login-action@v2.2.0
with:
username: ${{ secrets.DOCKERHUB_USR }}
password: ${{ secrets.DOCKERHUB_PWD }}
- name: Construindo a imagem do worker
  uses: docker/build-push-action@v4.1.1
  with:
  context: ./src
  file: ./src/Dockerfile
  push: true
  tags: |
  

CD:
runs-on: ubuntu-lastest
needs: [CI]
steps:
- name: Passo 01
run: echo "Baixar base de código"
- name: Passo 02
run: echo "Autenticar na AWS"
-name: Passo 03
run: echo "Deploy dos microsserviços no kubernetes"
